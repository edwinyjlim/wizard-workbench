procs:
  # ═══════════════════════════════════════════════════════════════════════════
  # DEV SERVERS - Auto-start for hot-reload development
  # ═══════════════════════════════════════════════════════════════════════════

  examples:
    # Resources manifest ZIP available at: http://localhost:8765/examples-mcp-resources.zip
    shell: "source .env && cd $EXAMPLES_PATH && npm run dev"
    autostart: true
    stop_signal: SIGTERM

  mcp:
    # Use dev:local-resources to read from local examples server 
    # Runs at http://localhost:8787
    shell: "source .env && cd $MCP_PATH && pnpm run dev:local-resources"
    autostart: true
    stop_signal: SIGTERM

  mcp-inspector:
    # Opens MCP Inspector UI at http://localhost:6274
    shell: "source .env && cd $MCP_PATH && pnpm run inspector"
    autostart: true

  wizard-build:
    # Skip global link - just build and watch. Use wizard-run to execute.
    shell: "source .env && cd $WIZARD_PATH && pnpm build && pnpm build:watch"
    autostart: true
    stop_signal: SIGTERM

  # ═══════════════════════════════════════════════════════════════════════════
  # WIZARD RUNS - Execute wizard on test apps (press 's' to start)
  # ═══════════════════════════════════════════════════════════════════════════

  wizard-run:
    # Interactive app selector - choose which app to run wizard on
    shell: "npx tsx services/wizard-run/index.ts"
    autostart: false
    env_file: .env

  wizard-tail-run:
    # Tail the wizard's verbose output
    shell: "tail -f /tmp/posthog-wizard.log"
    autostart: false

  # ═══════════════════════════════════════════════════════════════════════════
  # WIZARD CI - Run wizard and optionally create PR
  # ═══════════════════════════════════════════════════════════════════════════

  wizard-ci-run:
    # Runs the full CI flow, creates a PR on GH, and agent evaluates code 
    shell: "pnpm wizard-ci --evaluate"
    autostart: false
    env_file: .env

  wizard-ci-local-run:
    # Runs the CI flow code locally
    shell: "pnpm wizard-ci --local --evaluate"
    autostart: false
    env_file: .env

  wizard-ci-create-pr:
    # Only pushes branch and creates PR on GH
    shell: "pnpm wizard-ci --push-only --branch"
    autostart: false
    env_file: .env

  # ═══════════════════════════════════════════════════════════════════════════
  # PR/BRANCH EVALUATION
  # ═══════════════════════════════════════════════════════════════════════════

  wizard-ci-evaluate-pr:
    # Agent evaluates a PR or local branch
    shell: "pnpm run evaluate"
    autostart: false
    env_file: .env

